-- this code renders top selling regions with highest number of clients.
SELECT	
	COUNT(DISTINCT A.customer_id) AS count_customer,
	Count(E.rental_id) AS count_rentals,
	C.city,
	D.country,
	Sum(amount) AS sum_revenue
FROM customer A	
INNER JOIN address B on A.address_id = B.address_id	
INNER JOIN city C on B.city_id = C.city_id	
INNER JOIN country D on C.country_id = D.country_id	
INNER JOIN rental E on A.customer_id = E.customer_id	
INNER JOIN payment F on E.customer_id = F.customer_id	
GROUP BY	
	city, 
	country
ORDER BY count_customer DESC
